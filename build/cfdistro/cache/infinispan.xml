<project name="infinispan" basedir="./" xmlns:antcontrib="antlib:net.sf.antcontrib">

	<property name="infinispan.version" value="5.0.0.BETA1" />
	<property name="ext.infinispan.dir" location="${ext.dir}/infinispan/${infinispan.version}" />
	<property name="infinispan.dir" location="./infinispan${infinispan.version}" />
	<property name="ext.infinispan.zip.uri" value="http://downloads.sourceforge.net/project/infinispan/infinispan/${infinispan.version}/infinispan-${infinispan.version}-all.zip" />
	<property name="ext.infinispan.zip" location="${ext.infinispan.dir}/infinispan-${infinispan.version}.zip" />
	
	<target name="infinispan.install">
		<mkdir dir="${ext.infinispan.dir}"/>
		<sequential>
		<antcontrib:if>
			<available file="${ext.infinispan.zip}" />
			<then/>
			<else>
				<get src="${ext.infinispan.zip.uri}" dest="${ext.infinispan.zip}" verbose="true" ignoreerrors="false" />
			</else>
		</antcontrib:if>
		<unzip src="${ext.infinispan.zip}"						
		       dest="${infinispan.dir}">
			<regexpmapper from="infinispan-${infinispan.version}/(.*)$" to="\1"/>
		</unzip>
		<chmod dir="${infinispan.dir}/bin" perm="ugo+rx" 
		       includes="**/*.sh"/>
		</sequential>
	</target>
	
</project>